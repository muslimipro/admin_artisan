import{a as k,b as N,u as M}from"./api-client-1XAoszYe.js";import{d as D,k as F,a as y,v as Q,m as j,b as n,o as V,n as h,e as a,w as o,g as $,t as f,x as K,f as q,c as R,y as E,_ as O,F as H,u as U}from"./index-D2pX98g5.js";import"./base-url-qR72hEjy.js";const A={async getStudents(){const _=await k.get("/school/student/list/");return console.log(_.data),_.data},async addStudent(_){return(await k.post("/school/student/",_,{headers:{"Content-Type":"multipart/form-data"}})).data},async updateStudent(_,c){return(await k.put(`/school/student/${_}`,c,{headers:{"Content-Type":"multipart/form-data"}})).data},async deleteStudent(_){return(await k.delete(`/school/student/${_}`)).data}},W={class:"d-flex"},Y=D({__name:"AddStudentFormDialog",setup(_){const{t:c}=F(),d=y(!1),r=y(!1),m=y(!1),S=N(),l=y({name:"",login:"",password:"",image:null}),i=y(null),u=t=>{const e=t.target;e.files&&e.files[0]&&(l.value.image=e.files[0],i.value=URL.createObjectURL(e.files[0]))},v=Q(()=>l.value.login&&l.value.password&&l.value.name),w=async()=>{if(!v.value)return alert(c("pleaseFillInAllFields"));const t=new FormData;t.append("name",l.value.name),t.append("login",l.value.login),t.append("password",l.value.password),l.value.image!=null&&t.append("image",l.value.image),m.value=!0;try{await A.addStudent(t),S.invalidateQueries({queryKey:["students"]}),d.value=!1}catch(e){alert(`${c("failedToAddTeacher")}: ${e}`)}finally{m.value=!1}};return j(d,t=>{t==!1&&(l.value={name:"",login:"",password:"",image:null},i.value=null)}),(t,e)=>{const b=n("v-btn"),x=n("v-card-title"),g=n("v-text-field"),C=n("v-file-input"),p=n("v-img"),P=n("v-form"),I=n("v-card-text"),L=n("v-card-actions"),T=n("v-card"),B=n("v-dialog");return V(),h("div",null,[a(b,{color:"green",variant:"flat",onClick:e[0]||(e[0]=s=>d.value=!0)},{default:o(()=>[$(" + "+f(t.$t("add")),1)]),_:1}),a(B,{modelValue:d.value,"onUpdate:modelValue":e[7]||(e[7]=s=>d.value=s),"max-width":"600"},{default:o(()=>[a(T,{class:"pa-4"},{default:o(()=>[a(x,{class:"px-2"},{default:o(()=>[$(f(t.$t("createNewStudent")),1)]),_:1}),a(I,null,{default:o(()=>[a(P,{onSubmit:K(w,["prevent"])},{default:o(()=>[a(g,{modelValue:l.value.name,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.name=s),type:"text",density:"compact",label:t.$t("name"),placeholder:t.$t("nameSurname"),"prepend-inner-icon":"mdi-account-outline",variant:"outlined",required:""},null,8,["modelValue","label","placeholder"]),a(g,{modelValue:l.value.login,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.login=s),type:"email",density:"compact",label:t.$t("email"),placeholder:t.$t("emailAddress"),"prepend-inner-icon":"mdi-email-outline",variant:"outlined",required:""},null,8,["modelValue","label","placeholder"]),a(g,{modelValue:l.value.password,"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.password=s),"append-inner-icon":r.value?"mdi-eye-off":"mdi-eye",type:r.value?"text":"password",density:"compact",label:t.$t("password"),placeholder:t.$t("enterPassword"),"prepend-inner-icon":"mdi-lock-outline",variant:"outlined","onClick:appendInner":e[4]||(e[4]=s=>r.value=!r.value),required:""},null,8,["modelValue","append-inner-icon","type","label","placeholder"]),q("div",W,[a(C,{modelValue:l.value.image,"onUpdate:modelValue":e[5]||(e[5]=s=>l.value.image=s),"max-width":"100%",variant:"outlined",accept:"image/png, image/jpeg, image/bmp",label:t.$t("avatar"),placeholder:"Pick an avatar","prepend-icon":"mdi-camera",onChange:u,counter:"",required:""},null,8,["modelValue","label"]),i.value?(V(),R(p,{key:0,src:i.value,"max-width":"60","max-height":"60",class:"pa-0 ma-0"},null,8,["src"])):E("",!0)])]),_:1})]),_:1}),a(L,null,{default:o(()=>[a(b,{color:"red darken-1",variant:"text",onClick:e[6]||(e[6]=s=>d.value=!1)},{default:o(()=>[$(f(t.$t("cancel")),1)]),_:1}),a(b,{loading:m.value,color:"primary",variant:"flat",disabled:!v.value||m.value,onClick:w},{default:o(()=>[$(f(t.$t("create")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),z=O(Y,[["__scopeId","data-v-16095254"]]),G={class:"d-flex"},J=D({__name:"UpdateStudentFormDialog",props:{item:{}},setup(_){const{t:c}=F(),d=_,r=y(!1),m=y(!1),S=N(),l=y({name:d.item.name,image:null}),i=y(null);i.value=d.item.image;const u=t=>{const e=t.target;e.files&&e.files[0]&&(l.value.image=e.files[0],i.value=URL.createObjectURL(e.files[0]))},v=Q(()=>l.value.name),w=async()=>{if(!v.value)return alert(c("pleaseFillInAllFields"));const t=new FormData;t.append("name",l.value.name),l.value.image!=null&&t.append("image",l.value.image),m.value=!0;try{await A.updateStudent(d.item.id,t),S.invalidateQueries({queryKey:["students"]}),r.value=!1}catch(e){alert(`${c("failedToUpdateStudent")}: ${e}`)}finally{m.value=!1}};return j(r,t=>{t&&(l.value.name=d.item.name,l.value.image=null,i.value=d.item.image)}),(t,e)=>{const b=n("v-btn"),x=n("v-card-title"),g=n("v-text-field"),C=n("v-file-input"),p=n("v-img"),P=n("v-form"),I=n("v-card-text"),L=n("v-card-actions"),T=n("v-card"),B=n("v-dialog");return V(),h(H,null,[a(b,{icon:"mdi-pencil",variant:"plain",onClick:e[0]||(e[0]=s=>r.value=!0)}),a(B,{modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=s=>r.value=s),"max-width":"600"},{default:o(()=>[a(T,{class:"pa-4"},{default:o(()=>[a(x,{class:"px-2"},{default:o(()=>[$(f(t.$t("updateStudent")),1)]),_:1}),a(I,null,{default:o(()=>[a(P,{onSubmit:K(w,["prevent"])},{default:o(()=>[a(g,{modelValue:l.value.name,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.name=s),type:"text",density:"compact",label:t.$t("name"),placeholder:t.$t("nameSurname"),"prepend-inner-icon":"mdi-account-outline",variant:"outlined",required:""},null,8,["modelValue","label","placeholder"]),q("div",G,[a(C,{modelValue:l.value.image,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.image=s),"max-width":"100%",variant:"outlined",accept:"image/png, image/jpeg, image/bmp",label:t.$t("avatar"),placeholder:"Pick an avatar","prepend-icon":"mdi-camera",onChange:u,counter:"",required:""},null,8,["modelValue","label"]),i.value?(V(),R(p,{key:0,src:i.value,"max-width":"60","max-height":"60",class:"pa-0 ma-0"},null,8,["src"])):E("",!0)])]),_:1})]),_:1}),a(L,null,{default:o(()=>[a(b,{color:"red darken-1",variant:"text",onClick:e[3]||(e[3]=s=>r.value=!1)},{default:o(()=>[$(f(t.$t("cancel")),1)]),_:1}),a(b,{loading:m.value,color:"primary",variant:"flat",disabled:!v.value||m.value,onClick:w},{default:o(()=>[$(f(t.$t("save")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),X=O(J,[["__scopeId","data-v-8735bfa1"]]),Z=D({__name:"DeleteStudentFormDialog",props:{item:{}},setup(_){const{t:c}=F(),d=_,r=y(!1),m=y(!1),S=N();async function l(i){console.log(i.name),m.value=!0;try{await A.deleteStudent(i.id),S.invalidateQueries({queryKey:["students"]}),r.value=!1}catch(u){alert(`${c("failedToDeleteStudent")}: ${u}`)}finally{m.value=!1}}return(i,u)=>{const v=n("v-btn"),w=n("v-card-title"),t=n("v-card-text"),e=n("v-card"),b=n("v-card-actions"),x=n("v-dialog");return V(),h(H,null,[a(v,{icon:"mdi-delete",variant:"plain",loading:m.value,disabled:m.value,onClick:u[0]||(u[0]=g=>r.value=!0)},null,8,["loading","disabled"]),a(x,{modelValue:r.value,"onUpdate:modelValue":u[3]||(u[3]=g=>r.value=g),"max-width":"600"},{default:o(()=>[a(e,{class:"pa-4"},{default:o(()=>[a(w,{class:"px-2"},{default:o(()=>[$(f(i.$t("deleteStudent"))+"?",1)]),_:1}),a(e,{class:"ma-2",color:"yellow",variant:"tonal"},{default:o(()=>[a(t,{class:"text-medium-emphasis text-lg"},{default:o(()=>[$(f(i.$t("warningAllHisProgressDataWillBeRemovedPermanently")),1)]),_:1})]),_:1}),a(b,null,{default:o(()=>[a(v,{color:"green darken-1",variant:"text",onClick:u[1]||(u[1]=g=>r.value=!1)},{default:o(()=>[$(f(i.$t("cancel")),1)]),_:1}),a(v,{loading:m.value,color:"red",variant:"flat",disabled:m.value,onClick:u[2]||(u[2]=g=>l(d.item))},{default:o(()=>[$(f(i.$t("delete")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),ee={class:"text-center"},ae={key:0},te={key:1},de=D({__name:"StudentsView",setup(_){const{t:c}=F(),d=y(""),r=Q(()=>[{title:c("avatar"),value:"image"},{title:c("email"),value:"login"},{title:c("name"),value:"name"},{title:c("class.nominative"),value:"user_data.school_student.name"},{title:c("active"),value:"active"},{title:"Actions",value:"actions"}]),{isPending:m,isError:S,data:l,error:i}=M({queryKey:["students"],queryFn:async()=>await A.getStudents()});return(u,v)=>{const w=n("v-text-field"),t=n("v-spacer"),e=n("v-card-title"),b=n("v-divider"),x=n("v-avatar"),g=n("v-data-table"),C=n("v-card");return V(),R(C,{flat:"",width:"100%"},{default:o(()=>[a(e,{class:"d-flex align-center pb-4"},{default:o(()=>[a(w,{modelValue:d.value,"onUpdate:modelValue":v[0]||(v[0]=p=>d.value=p),density:"compact",label:u.$t("search"),"prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":""},null,8,["modelValue","label"]),a(t),a(z)]),_:1}),a(b),a(g,{search:d.value,"onUpdate:search":v[1]||(v[1]=p=>d.value=p),headers:r.value,items:U(l),loading:U(m),class:"px-4","items-per-page-text":u.$t("itemsPerPage")},{"header.actions":o(()=>v[2]||(v[2]=[q("div",{class:"text-center"},null,-1)])),"item.image":o(({item:p})=>[a(x,{color:"grey",image:p.image||""},null,8,["image"])]),"item.actions":o(({item:p})=>[q("div",ee,[a(X,{item:p},null,8,["item"]),a(Z,{item:p},null,8,["item"])])]),"no-data":o(()=>{var p;return[U(S)?(V(),h("div",ae,f((p=U(i))==null?void 0:p.message),1)):(V(),h("div",te,f(u.$t("noDataYet")),1))]}),_:1},8,["search","headers","items","loading","items-per-page-text"])]),_:1})}}});export{de as default};
