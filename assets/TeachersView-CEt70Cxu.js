import{a as T,b as L,u as O}from"./api-client-v2akKp4R.js";import{d as q,a as f,k as E,l as Q,b as l,o as b,m as U,e as a,w as n,g as y,n as B,f as k,c as P,p as I,_ as K,F as R,t as j,u as $}from"./index-DMjYued5.js";import"./base-url-qR72hEjy.js";const D={async getTeachers(){const p=await T.get("/school/teacher/list/");return console.log(p.data),p.data},async addTeacher(p){return(await T.post("/school/teacher/",p,{headers:{"Content-Type":"multipart/form-data"}})).data},async updateTeacher(p,r){return(await T.put(`/school/teacher/${p}`,r,{headers:{"Content-Type":"multipart/form-data"}})).data},async deleteTeacher(p){return(await T.delete(`/school/teacher/${p}`)).data}},M={class:"d-flex"},W=q({__name:"AddTeacherFormDialog",setup(p){const r=f(!1),s=f(!1),u=f(!1),w=L(),t=f({name:"",login:"",password:"",image:null}),v=f(null),o=i=>{const e=i.target;e.files&&e.files[0]&&(t.value.image=e.files[0],v.value=URL.createObjectURL(e.files[0]))},c=E(()=>t.value.login&&t.value.password&&t.value.name),x=async()=>{if(!c.value)return alert("Please fill in all fields and upload an avatar.");const i=new FormData;i.append("name",t.value.name),i.append("login",t.value.login),i.append("password",t.value.password),t.value.image!=null&&i.append("image",t.value.image),u.value=!0;try{await D.addTeacher(i),w.invalidateQueries({queryKey:["teachers"]}),r.value=!1}catch(e){alert(`Failed to add teacher: ${e}`)}finally{u.value=!1}};return Q(r,i=>{i==!1&&(t.value={name:"",login:"",password:"",image:null},v.value=null)}),(i,e)=>{const g=l("v-btn"),V=l("v-card-title"),_=l("v-text-field"),C=l("v-file-input"),m=l("v-img"),h=l("v-form"),F=l("v-card-text"),A=l("v-card-actions"),N=l("v-card"),S=l("v-dialog");return b(),U("div",null,[a(g,{color:"green",variant:"flat",onClick:e[0]||(e[0]=d=>r.value=!0)},{default:n(()=>e[8]||(e[8]=[y(" + Add ")])),_:1}),a(S,{modelValue:r.value,"onUpdate:modelValue":e[7]||(e[7]=d=>r.value=d),"max-width":"600"},{default:n(()=>[a(N,{class:"pa-4"},{default:n(()=>[a(V,{class:"px-2"},{default:n(()=>e[9]||(e[9]=[y("Create a New Teacher")])),_:1}),a(F,null,{default:n(()=>[a(h,{onSubmit:B(x,["prevent"])},{default:n(()=>[a(_,{modelValue:t.value.name,"onUpdate:modelValue":e[1]||(e[1]=d=>t.value.name=d),type:"text",density:"compact",label:"Name",placeholder:"Name Surname","prepend-inner-icon":"mdi-account-outline",variant:"outlined",required:""},null,8,["modelValue"]),a(_,{modelValue:t.value.login,"onUpdate:modelValue":e[2]||(e[2]=d=>t.value.login=d),type:"email",density:"compact",label:"Email",placeholder:"Email address","prepend-inner-icon":"mdi-email-outline",variant:"outlined",required:""},null,8,["modelValue"]),a(_,{modelValue:t.value.password,"onUpdate:modelValue":e[3]||(e[3]=d=>t.value.password=d),"append-inner-icon":s.value?"mdi-eye-off":"mdi-eye",type:s.value?"text":"password",density:"compact",label:"Password",placeholder:"Enter password","prepend-inner-icon":"mdi-lock-outline",variant:"outlined","onClick:appendInner":e[4]||(e[4]=d=>s.value=!s.value),required:""},null,8,["modelValue","append-inner-icon","type"]),k("div",M,[a(C,{modelValue:t.value.image,"onUpdate:modelValue":e[5]||(e[5]=d=>t.value.image=d),"max-width":"100%",variant:"outlined",accept:"image/png, image/jpeg, image/bmp",label:"Avatar",placeholder:"Pick an avatar","prepend-icon":"mdi-camera",onChange:o,counter:"",required:""},null,8,["modelValue"]),v.value?(b(),P(m,{key:0,src:v.value,"max-width":"60","max-height":"60",class:"pa-0 ma-0"},null,8,["src"])):I("",!0)])]),_:1})]),_:1}),a(A,null,{default:n(()=>[a(g,{color:"red darken-1",variant:"text",onClick:e[6]||(e[6]=d=>r.value=!1)},{default:n(()=>e[10]||(e[10]=[y(" Cancel ")])),_:1}),a(g,{loading:u.value,color:"primary",variant:"flat",disabled:!c.value||u.value,onClick:x},{default:n(()=>e[11]||(e[11]=[y(" Submit ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),z=K(W,[["__scopeId","data-v-cac40b5d"]]),G={class:"d-flex"},H=q({__name:"UpdateTeacherFormDialog",props:{item:{}},setup(p){const r=p,s=f(!1),u=f(!1),w=L(),t=f({name:r.item.name,image:null}),v=f(null),o=i=>{const e=i.target;e.files&&e.files[0]&&(t.value.image=e.files[0],v.value=URL.createObjectURL(e.files[0]))},c=E(()=>t.value.name),x=async()=>{if(!c.value)return alert("Please fill in all fields");const i=new FormData;i.append("name",t.value.name),t.value.image!=null&&i.append("image",t.value.image),u.value=!0;try{await D.updateTeacher(r.item.id,i),w.invalidateQueries({queryKey:["teachers"]}),s.value=!1}catch(e){alert(`Failed to update teacher: ${e}`)}finally{u.value=!1}};return Q(s,i=>{i&&(t.value.name=r.item.name,t.value.image=null,v.value=r.item.image)}),(i,e)=>{const g=l("v-btn"),V=l("v-card-title"),_=l("v-text-field"),C=l("v-file-input"),m=l("v-img"),h=l("v-form"),F=l("v-card-text"),A=l("v-card-actions"),N=l("v-card"),S=l("v-dialog");return b(),U(R,null,[a(g,{icon:"mdi-pencil",variant:"plain",onClick:e[0]||(e[0]=d=>s.value=!0)}),a(S,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=d=>s.value=d),"max-width":"600"},{default:n(()=>[a(N,{class:"pa-4"},{default:n(()=>[a(V,{class:"px-2"},{default:n(()=>e[5]||(e[5]=[y("Update Teacher")])),_:1}),a(F,null,{default:n(()=>[a(h,{onSubmit:B(x,["prevent"])},{default:n(()=>[a(_,{modelValue:t.value.name,"onUpdate:modelValue":e[1]||(e[1]=d=>t.value.name=d),type:"text",density:"compact",label:"Name",placeholder:"Name Surname","prepend-inner-icon":"mdi-account-outline",variant:"outlined",required:""},null,8,["modelValue"]),k("div",G,[a(C,{modelValue:t.value.image,"onUpdate:modelValue":e[2]||(e[2]=d=>t.value.image=d),"max-width":"100%",variant:"outlined",accept:"image/png, image/jpeg, image/bmp",label:"Avatar",placeholder:"Pick an avatar","prepend-icon":"mdi-camera",onChange:o,counter:"",required:""},null,8,["modelValue"]),v.value?(b(),P(m,{key:0,src:v.value,"max-width":"60","max-height":"60",class:"pa-0 ma-0"},null,8,["src"])):I("",!0)])]),_:1})]),_:1}),a(A,null,{default:n(()=>[a(g,{color:"red darken-1",variant:"text",onClick:e[3]||(e[3]=d=>s.value=!1)},{default:n(()=>e[6]||(e[6]=[y(" Cancel ")])),_:1}),a(g,{loading:u.value,color:"primary",variant:"flat",disabled:!c.value||u.value,onClick:x},{default:n(()=>e[7]||(e[7]=[y(" Submit ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),J=K(H,[["__scopeId","data-v-ccc9fa14"]]),X=q({__name:"DeleteTeacherFormDialog",props:{item:{}},setup(p){const r=p,s=f(!1),u=f(!1),w=L();async function t(v){console.log(v.name),u.value=!0;try{await D.deleteTeacher(v.id),w.invalidateQueries({queryKey:["teachers"]}),s.value=!1}catch(o){alert(`Failed to delete teacher: ${o}`)}finally{u.value=!1}}return(v,o)=>{const c=l("v-btn"),x=l("v-card-title"),i=l("v-card-text"),e=l("v-card"),g=l("v-card-actions"),V=l("v-dialog");return b(),U(R,null,[a(c,{icon:"mdi-delete",variant:"plain",loading:u.value,disabled:u.value,onClick:o[0]||(o[0]=_=>s.value=!0)},null,8,["loading","disabled"]),a(V,{modelValue:s.value,"onUpdate:modelValue":o[3]||(o[3]=_=>s.value=_),"max-width":"600"},{default:n(()=>[a(e,{class:"pa-4"},{default:n(()=>[a(x,{class:"px-2"},{default:n(()=>o[4]||(o[4]=[y("Delete teacher?")])),_:1}),a(e,{class:"ma-2",color:"yellow",variant:"tonal"},{default:n(()=>[a(i,{class:"text-medium-emphasis text-lg"},{default:n(()=>o[5]||(o[5]=[y(" Warning: All his progress, data will be removed permanently ")])),_:1})]),_:1}),a(g,null,{default:n(()=>[a(c,{color:"green darken-1",variant:"text",onClick:o[1]||(o[1]=_=>s.value=!1)},{default:n(()=>o[6]||(o[6]=[y(" Cancel ")])),_:1}),a(c,{loading:u.value,color:"red",variant:"flat",disabled:u.value,onClick:o[2]||(o[2]=_=>t(r.item))},{default:n(()=>o[7]||(o[7]=[y(" Delete ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),Y={class:"text-center"},Z={key:0},ee={key:1},ne=q({__name:"TeachersView",setup(p){const r=f(""),s=[{title:"Avatar",value:"image"},{title:"Login",value:"login"},{title:"Name",value:"name"},{title:"Classes",value:"classes"},{title:"Active",value:"active"},{title:"Actions",value:"actions"}],{isPending:u,isError:w,data:t,error:v}=O({queryKey:["teachers"],queryFn:async()=>await D.getTeachers()});return(o,c)=>{const x=l("v-text-field"),i=l("v-spacer"),e=l("v-card-title"),g=l("v-divider"),V=l("v-avatar"),_=l("v-data-table"),C=l("v-card");return b(),P(C,{flat:"",width:"100%"},{default:n(()=>[a(e,{class:"d-flex align-center pb-4"},{default:n(()=>[a(x,{modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=m=>r.value=m),density:"compact",label:"Search","prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":""},null,8,["modelValue"]),a(i),a(z)]),_:1}),a(g),a(_,{search:r.value,"onUpdate:search":c[1]||(c[1]=m=>r.value=m),headers:s,items:$(t),loading:$(u),class:"px-4"},{"header.actions":n(()=>c[2]||(c[2]=[k("div",{class:"text-center"},null,-1)])),"item.image":n(({item:m})=>[a(V,{color:"grey",image:m.image||""},null,8,["image"])]),"item.classes":n(({item:m})=>[k("span",null,j(m.user_data.school_teacher.map(h=>h.name).join(", ")),1)]),"item.actions":n(({item:m})=>[k("div",Y,[a(J,{item:m},null,8,["item"]),a(X,{item:m},null,8,["item"])])]),"no-data":n(()=>{var m;return[$(w)?(b(),U("div",Z,j((m=$(v))==null?void 0:m.message),1)):(b(),U("div",ee," No data yet... "))]}),_:1},8,["search","items","loading"])]),_:1})}}});export{ne as default};
