import{a as q,b as B,u as M}from"./api-client-1XAoszYe.js";import{d as F,k as A,a as h,v as N,m as R,b as n,o as w,n as U,e as a,w as o,g as $,t as f,x as K,f as k,c as Q,y as E,_ as O,F as H,u as D}from"./index-D2pX98g5.js";import"./base-url-qR72hEjy.js";const P={async getTeachers(){const _=await q.get("/school/teacher/list/");return console.log(_.data),_.data},async addTeacher(_){return(await q.post("/school/teacher/",_,{headers:{"Content-Type":"multipart/form-data"}})).data},async updateTeacher(_,m){return(await q.put(`/school/teacher/${_}`,m,{headers:{"Content-Type":"multipart/form-data"}})).data},async deleteTeacher(_){return(await q.delete(`/school/teacher/${_}`)).data}},W={class:"d-flex"},Y=F({__name:"AddTeacherFormDialog",setup(_){const{t:m}=A(),r=h(!1),s=h(!1),c=h(!1),V=B(),l=h({name:"",login:"",password:"",image:null}),d=h(null),u=t=>{const e=t.target;e.files&&e.files[0]&&(l.value.image=e.files[0],d.value=URL.createObjectURL(e.files[0]))},p=N(()=>l.value.login&&l.value.password&&l.value.name),b=async()=>{if(!p.value)return alert(m("pleaseFillInAllFields"));const t=new FormData;t.append("name",l.value.name),t.append("login",l.value.login),t.append("password",l.value.password),l.value.image!=null&&t.append("image",l.value.image),c.value=!0;try{await P.addTeacher(t),V.invalidateQueries({queryKey:["teachers"]}),r.value=!1}catch(e){alert(`${m("failedToAddTeacher")}: ${e}`)}finally{c.value=!1}};return R(r,t=>{t==!1&&(l.value={name:"",login:"",password:"",image:null},d.value=null)}),(t,e)=>{const y=n("v-btn"),T=n("v-card-title"),g=n("v-text-field"),x=n("v-file-input"),v=n("v-img"),C=n("v-form"),I=n("v-card-text"),L=n("v-card-actions"),S=n("v-card"),j=n("v-dialog");return w(),U("div",null,[a(y,{color:"green",variant:"flat",onClick:e[0]||(e[0]=i=>r.value=!0)},{default:o(()=>[$(" + "+f(t.$t("add")),1)]),_:1}),a(j,{modelValue:r.value,"onUpdate:modelValue":e[7]||(e[7]=i=>r.value=i),"max-width":"600"},{default:o(()=>[a(S,{class:"pa-4"},{default:o(()=>[a(T,{class:"px-2"},{default:o(()=>[$(f(t.$t("createNewTeacher")),1)]),_:1}),a(I,null,{default:o(()=>[a(C,{onSubmit:K(b,["prevent"])},{default:o(()=>[a(g,{modelValue:l.value.name,"onUpdate:modelValue":e[1]||(e[1]=i=>l.value.name=i),type:"text",density:"compact",label:t.$t("name"),placeholder:t.$t("nameSurname"),"prepend-inner-icon":"mdi-account-outline",variant:"outlined",required:""},null,8,["modelValue","label","placeholder"]),a(g,{modelValue:l.value.login,"onUpdate:modelValue":e[2]||(e[2]=i=>l.value.login=i),type:"email",density:"compact",label:t.$t("email"),placeholder:t.$t("emailAddress"),"prepend-inner-icon":"mdi-email-outline",variant:"outlined",required:""},null,8,["modelValue","label","placeholder"]),a(g,{modelValue:l.value.password,"onUpdate:modelValue":e[3]||(e[3]=i=>l.value.password=i),"append-inner-icon":s.value?"mdi-eye-off":"mdi-eye",type:s.value?"text":"password",density:"compact",label:t.$t("password"),placeholder:t.$t("enterPassword"),"prepend-inner-icon":"mdi-lock-outline",variant:"outlined","onClick:appendInner":e[4]||(e[4]=i=>s.value=!s.value),required:""},null,8,["modelValue","append-inner-icon","type","label","placeholder"]),k("div",W,[a(x,{modelValue:l.value.image,"onUpdate:modelValue":e[5]||(e[5]=i=>l.value.image=i),"max-width":"100%",variant:"outlined",accept:"image/png, image/jpeg, image/bmp",label:t.$t("avatar"),placeholder:"Pick an avatar","prepend-icon":"mdi-camera",onChange:u,counter:"",required:""},null,8,["modelValue","label"]),d.value?(w(),Q(v,{key:0,src:d.value,"max-width":"60","max-height":"60",class:"pa-0 ma-0"},null,8,["src"])):E("",!0)])]),_:1})]),_:1}),a(L,null,{default:o(()=>[a(y,{color:"red darken-1",variant:"text",onClick:e[6]||(e[6]=i=>r.value=!1)},{default:o(()=>[$(f(t.$t("cancel")),1)]),_:1}),a(y,{loading:c.value,color:"primary",variant:"flat",disabled:!p.value||c.value,onClick:b},{default:o(()=>[$(f(t.$t("create")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),z=O(Y,[["__scopeId","data-v-e3a38069"]]),G={class:"d-flex"},J=F({__name:"UpdateTeacherFormDialog",props:{item:{}},setup(_){const{t:m}=A(),r=_,s=h(!1),c=h(!1),V=B(),l=h({name:r.item.name,image:null}),d=h(null),u=t=>{const e=t.target;e.files&&e.files[0]&&(l.value.image=e.files[0],d.value=URL.createObjectURL(e.files[0]))},p=N(()=>l.value.name),b=async()=>{if(!p.value)return alert(m("pleaseFillInAllFields"));const t=new FormData;t.append("name",l.value.name),l.value.image!=null&&t.append("image",l.value.image),c.value=!0;try{await P.updateTeacher(r.item.id,t),V.invalidateQueries({queryKey:["teachers"]}),s.value=!1}catch(e){alert(`${m("failedToUpdateTeacher")}: ${e}`)}finally{c.value=!1}};return R(s,t=>{t&&(l.value.name=r.item.name,l.value.image=null,d.value=r.item.image)}),(t,e)=>{const y=n("v-btn"),T=n("v-card-title"),g=n("v-text-field"),x=n("v-file-input"),v=n("v-img"),C=n("v-form"),I=n("v-card-text"),L=n("v-card-actions"),S=n("v-card"),j=n("v-dialog");return w(),U(H,null,[a(y,{icon:"mdi-pencil",variant:"plain",onClick:e[0]||(e[0]=i=>s.value=!0)}),a(j,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=i=>s.value=i),"max-width":"600"},{default:o(()=>[a(S,{class:"pa-4"},{default:o(()=>[a(T,{class:"px-2"},{default:o(()=>[$(f(t.$t("updateTeacher")),1)]),_:1}),a(I,null,{default:o(()=>[a(C,{onSubmit:K(b,["prevent"])},{default:o(()=>[a(g,{modelValue:l.value.name,"onUpdate:modelValue":e[1]||(e[1]=i=>l.value.name=i),type:"text",density:"compact",label:t.$t("name"),placeholder:t.$t("nameSurname"),"prepend-inner-icon":"mdi-account-outline",variant:"outlined",required:""},null,8,["modelValue","label","placeholder"]),k("div",G,[a(x,{modelValue:l.value.image,"onUpdate:modelValue":e[2]||(e[2]=i=>l.value.image=i),"max-width":"100%",variant:"outlined",accept:"image/png, image/jpeg, image/bmp",label:t.$t("avatar"),placeholder:"Pick an avatar","prepend-icon":"mdi-camera",onChange:u,counter:"",required:""},null,8,["modelValue","label"]),d.value?(w(),Q(v,{key:0,src:d.value,"max-width":"60","max-height":"60",class:"pa-0 ma-0"},null,8,["src"])):E("",!0)])]),_:1})]),_:1}),a(L,null,{default:o(()=>[a(y,{color:"red darken-1",variant:"text",onClick:e[3]||(e[3]=i=>s.value=!1)},{default:o(()=>[$(f(t.$t("cancel")),1)]),_:1}),a(y,{loading:c.value,color:"primary",variant:"flat",disabled:!p.value||c.value,onClick:b},{default:o(()=>[$(f(t.$t("save")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),X=O(J,[["__scopeId","data-v-4158f147"]]),Z=F({__name:"DeleteTeacherFormDialog",props:{item:{}},setup(_){const{t:m}=A(),r=_,s=h(!1),c=h(!1),V=B();async function l(d){console.log(d.name),c.value=!0;try{await P.deleteTeacher(d.id),V.invalidateQueries({queryKey:["teachers"]}),s.value=!1}catch(u){alert(`${m("failedToDeleteTeacher")}: ${u}`)}finally{c.value=!1}}return(d,u)=>{const p=n("v-btn"),b=n("v-card-title"),t=n("v-card-text"),e=n("v-card"),y=n("v-card-actions"),T=n("v-dialog");return w(),U(H,null,[a(p,{icon:"mdi-delete",variant:"plain",loading:c.value,disabled:c.value,onClick:u[0]||(u[0]=g=>s.value=!0)},null,8,["loading","disabled"]),a(T,{modelValue:s.value,"onUpdate:modelValue":u[3]||(u[3]=g=>s.value=g),"max-width":"600"},{default:o(()=>[a(e,{class:"pa-4"},{default:o(()=>[a(b,{class:"px-2"},{default:o(()=>[$(f(d.$t("deleteTeacher"))+"?",1)]),_:1}),a(e,{class:"ma-2",color:"yellow",variant:"tonal"},{default:o(()=>[a(t,{class:"text-medium-emphasis text-lg"},{default:o(()=>[$(f(d.$t("warningAllHisProgressDataWillBeRemovedPermanently")),1)]),_:1})]),_:1}),a(y,null,{default:o(()=>[a(p,{color:"green darken-1",variant:"text",onClick:u[1]||(u[1]=g=>s.value=!1)},{default:o(()=>[$(f(d.$t("cancel")),1)]),_:1}),a(p,{loading:c.value,color:"red",variant:"flat",disabled:c.value,onClick:u[2]||(u[2]=g=>l(r.item))},{default:o(()=>[$(f(d.$t("delete")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),ee={class:"text-center"},ae={key:0},te={key:1},ie=F({__name:"TeachersView",setup(_){const{t:m}=A(),r=h(""),s=N(()=>[{title:m("avatar"),value:"image"},{title:m("email"),value:"login"},{title:m("name"),value:"name"},{title:m("classes"),value:"classes"},{title:m("active"),value:"active"},{title:"Actions",value:"actions"}]),{isPending:c,isError:V,data:l,error:d}=M({queryKey:["teachers"],queryFn:async()=>await P.getTeachers()});return(u,p)=>{const b=n("v-text-field"),t=n("v-spacer"),e=n("v-card-title"),y=n("v-divider"),T=n("v-avatar"),g=n("v-data-table"),x=n("v-card");return w(),Q(x,{flat:"",width:"100%"},{default:o(()=>[a(e,{class:"d-flex align-center pb-4"},{default:o(()=>[a(b,{modelValue:r.value,"onUpdate:modelValue":p[0]||(p[0]=v=>r.value=v),density:"compact",label:u.$t("search"),"prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":""},null,8,["modelValue","label"]),a(t),a(z)]),_:1}),a(y),a(g,{search:r.value,"onUpdate:search":p[1]||(p[1]=v=>r.value=v),headers:s.value,items:D(l),loading:D(c),class:"px-4","items-per-page-text":u.$t("itemsPerPage")},{"header.actions":o(()=>p[2]||(p[2]=[k("div",{class:"text-center"},null,-1)])),"item.image":o(({item:v})=>[a(T,{color:"grey",image:v.image||""},null,8,["image"])]),"item.classes":o(({item:v})=>[k("span",null,f(v.user_data.school_teacher.map(C=>C.name).join(", ")),1)]),"item.actions":o(({item:v})=>[k("div",ee,[a(X,{item:v},null,8,["item"]),a(Z,{item:v},null,8,["item"])])]),"no-data":o(()=>{var v;return[D(V)?(w(),U("div",ae,f((v=D(d))==null?void 0:v.message),1)):(w(),U("div",te,f(u.$t("noDataYet")),1))]}),_:1},8,["search","headers","items","loading","items-per-page-text"])]),_:1})}}});export{ie as default};
