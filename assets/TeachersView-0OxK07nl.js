import{a as k,u as L,b as R}from"./api-client-VCmGk3ZT.js";import{d as $,a as f,k as E,l as Q,b as t,o as b,m as h,e as a,w as n,g as y,n as j,f as T,c as P,p as B,_ as I,F as K,u as U,t as O}from"./index-cj25IQ4H.js";import"./base-url-qR72hEjy.js";const q={async getTeachers(){const p=await k.get("/school/teacher/list/");return console.log(p.data),p.data},async addTeacher(p){return(await k.post("/school/teacher/",p,{headers:{"Content-Type":"multipart/form-data"}})).data},async updateTeacher(p,r){return(await k.put(`/school/teacher/${p}`,r,{headers:{"Content-Type":"multipart/form-data"}})).data},async deleteTeacher(p){return(await k.delete(`/school/teacher/${p}`)).data}},M={class:"d-flex"},W=$({__name:"AddTeacherFormDialog",setup(p){const r=f(!1),d=f(!1),u=f(!1),w=L(),l=f({name:"",login:"",password:"",image:null}),c=f(null),o=i=>{const e=i.target;e.files&&e.files[0]&&(l.value.image=e.files[0],c.value=URL.createObjectURL(e.files[0]))},m=E(()=>l.value.login&&l.value.password&&l.value.name),x=async()=>{if(!m.value)return alert("Please fill in all fields and upload an avatar.");const i=new FormData;i.append("name",l.value.name),i.append("login",l.value.login),i.append("password",l.value.password),i.append("image",l.value.image),u.value=!0;try{await q.addTeacher(i),w.invalidateQueries({queryKey:["teachers"]}),r.value=!1}catch(e){alert(`Failed to add teacher: ${e}`)}finally{u.value=!1}};return Q(r,i=>{i==!1&&(l.value={name:"",login:"",password:"",image:null},c.value=null)}),(i,e)=>{const g=t("v-btn"),V=t("v-card-title"),_=t("v-text-field"),C=t("v-file-input"),v=t("v-img"),D=t("v-form"),F=t("v-card-text"),A=t("v-card-actions"),N=t("v-card"),S=t("v-dialog");return b(),h("div",null,[a(g,{color:"green",variant:"flat",onClick:e[0]||(e[0]=s=>r.value=!0)},{default:n(()=>e[8]||(e[8]=[y(" + Add ")])),_:1}),a(S,{modelValue:r.value,"onUpdate:modelValue":e[7]||(e[7]=s=>r.value=s),"max-width":"600"},{default:n(()=>[a(N,{class:"pa-4"},{default:n(()=>[a(V,{class:"px-2"},{default:n(()=>e[9]||(e[9]=[y("Create a New Teacher")])),_:1}),a(F,null,{default:n(()=>[a(D,{onSubmit:j(x,["prevent"])},{default:n(()=>[a(_,{modelValue:l.value.name,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.name=s),type:"text",density:"compact",label:"Name",placeholder:"Name Surname","prepend-inner-icon":"mdi-account-outline",variant:"outlined",required:""},null,8,["modelValue"]),a(_,{modelValue:l.value.login,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.login=s),type:"email",density:"compact",label:"Email",placeholder:"Email address","prepend-inner-icon":"mdi-email-outline",variant:"outlined",required:""},null,8,["modelValue"]),a(_,{modelValue:l.value.password,"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.password=s),"append-inner-icon":d.value?"mdi-eye-off":"mdi-eye",type:d.value?"text":"password",density:"compact",label:"Password",placeholder:"Enter password","prepend-inner-icon":"mdi-lock-outline",variant:"outlined","onClick:appendInner":e[4]||(e[4]=s=>d.value=!d.value),required:""},null,8,["modelValue","append-inner-icon","type"]),T("div",M,[a(C,{modelValue:l.value.image,"onUpdate:modelValue":e[5]||(e[5]=s=>l.value.image=s),"max-width":"100%",variant:"outlined",accept:"image/png, image/jpeg, image/bmp",label:"Avatar",placeholder:"Pick an avatar","prepend-icon":"mdi-camera",onChange:o,counter:"",required:""},null,8,["modelValue"]),c.value?(b(),P(v,{key:0,src:c.value,"max-width":"60","max-height":"60",class:"pa-0 ma-0"},null,8,["src"])):B("",!0)])]),_:1})]),_:1}),a(A,null,{default:n(()=>[a(g,{color:"red darken-1",variant:"text",onClick:e[6]||(e[6]=s=>r.value=!1)},{default:n(()=>e[10]||(e[10]=[y(" Cancel ")])),_:1}),a(g,{loading:u.value,color:"primary",variant:"flat",disabled:!m.value||u.value,onClick:x},{default:n(()=>e[11]||(e[11]=[y(" Submit ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),z=I(W,[["__scopeId","data-v-503bbf30"]]),G={class:"d-flex"},H=$({__name:"UpdateTeacherFormDialog",props:{item:{}},setup(p){const r=p,d=f(!1),u=f(!1),w=L(),l=f({name:r.item.name,image:null}),c=f(null),o=i=>{const e=i.target;e.files&&e.files[0]&&(l.value.image=e.files[0],c.value=URL.createObjectURL(e.files[0]))},m=E(()=>l.value.name),x=async()=>{if(!m.value)return alert("Please fill in all fields");const i=new FormData;i.append("name",l.value.name),l.value.image!=null&&i.append("image",l.value.image),u.value=!0;try{await q.updateTeacher(r.item.id,i),w.invalidateQueries({queryKey:["teachers"]}),d.value=!1}catch(e){alert(`Failed to update teacher: ${e}`)}finally{u.value=!1}};return Q(d,i=>{i==!1&&(l.value={name:"",image:null},c.value=null)}),(i,e)=>{const g=t("v-btn"),V=t("v-card-title"),_=t("v-text-field"),C=t("v-file-input"),v=t("v-img"),D=t("v-form"),F=t("v-card-text"),A=t("v-card-actions"),N=t("v-card"),S=t("v-dialog");return b(),h(K,null,[a(g,{icon:"mdi-pencil",variant:"plain",onClick:e[0]||(e[0]=s=>d.value=!0)}),a(S,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=s=>d.value=s),"max-width":"600"},{default:n(()=>[a(N,{class:"pa-4"},{default:n(()=>[a(V,{class:"px-2"},{default:n(()=>e[5]||(e[5]=[y("Update Teacher")])),_:1}),a(F,null,{default:n(()=>[a(D,{onSubmit:j(x,["prevent"])},{default:n(()=>[a(_,{modelValue:l.value.name,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.name=s),type:"text",density:"compact",label:"Name",placeholder:"Name Surname","prepend-inner-icon":"mdi-account-outline",variant:"outlined",required:""},null,8,["modelValue"]),T("div",G,[a(C,{modelValue:l.value.image,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.image=s),"max-width":"100%",variant:"outlined",accept:"image/png, image/jpeg, image/bmp",label:"Avatar",placeholder:"Pick an avatar","prepend-icon":"mdi-camera",onChange:o,counter:"",required:""},null,8,["modelValue"]),c.value?(b(),P(v,{key:0,src:c.value,"max-width":"60","max-height":"60",class:"pa-0 ma-0"},null,8,["src"])):B("",!0)])]),_:1})]),_:1}),a(A,null,{default:n(()=>[a(g,{color:"red darken-1",variant:"text",onClick:e[3]||(e[3]=s=>d.value=!1)},{default:n(()=>e[6]||(e[6]=[y(" Cancel ")])),_:1}),a(g,{loading:u.value,color:"primary",variant:"flat",disabled:!m.value||u.value,onClick:x},{default:n(()=>e[7]||(e[7]=[y(" Submit ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),J=I(H,[["__scopeId","data-v-14268e77"]]),X=$({__name:"DeleteTeacherFormDialog",props:{item:{}},setup(p){const r=p,d=f(!1),u=f(!1),w=L();async function l(c){console.log(c.name),u.value=!0;try{await q.deleteTeacher(c.id),w.invalidateQueries({queryKey:["teachers"]}),d.value=!1}catch(o){alert(`Failed to delete teacher: ${o}`)}finally{u.value=!1}}return(c,o)=>{const m=t("v-btn"),x=t("v-card-title"),i=t("v-card-text"),e=t("v-card"),g=t("v-card-actions"),V=t("v-dialog");return b(),h(K,null,[a(m,{icon:"mdi-delete",variant:"plain",loading:u.value,disabled:u.value,onClick:o[0]||(o[0]=_=>d.value=!0)},null,8,["loading","disabled"]),a(V,{modelValue:d.value,"onUpdate:modelValue":o[3]||(o[3]=_=>d.value=_),"max-width":"600"},{default:n(()=>[a(e,{class:"pa-4"},{default:n(()=>[a(x,{class:"px-2"},{default:n(()=>o[4]||(o[4]=[y("Delete teacher?")])),_:1}),a(e,{class:"ma-2",color:"yellow",variant:"tonal"},{default:n(()=>[a(i,{class:"text-medium-emphasis text-lg"},{default:n(()=>o[5]||(o[5]=[y(" Warning: All his progress, data will be removed permanently ")])),_:1})]),_:1}),a(g,null,{default:n(()=>[a(m,{color:"green darken-1",variant:"text",onClick:o[1]||(o[1]=_=>d.value=!1)},{default:n(()=>o[6]||(o[6]=[y(" Cancel ")])),_:1}),a(m,{loading:u.value,color:"red",variant:"flat",disabled:u.value,onClick:o[2]||(o[2]=_=>l(r.item))},{default:n(()=>o[7]||(o[7]=[y(" Delete ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),Y={class:"text-center"},Z={key:0},ee={key:1},ne=$({__name:"TeachersView",setup(p){const r=f(""),d=[{title:"Avatar",value:"image"},{title:"Name",value:"name"},{title:"Class",value:"user_data.school_class_id"},{title:"Active",value:"active"},{title:"Actions",value:"actions"}],{isPending:u,isError:w,data:l,error:c}=R({queryKey:["teachers"],queryFn:async()=>await q.getTeachers()});return(o,m)=>{const x=t("v-text-field"),i=t("v-spacer"),e=t("v-card-title"),g=t("v-divider"),V=t("v-avatar"),_=t("v-data-table"),C=t("v-card");return b(),P(C,{flat:"",width:"100%"},{default:n(()=>[a(e,{class:"d-flex align-center pb-4"},{default:n(()=>[a(x,{modelValue:r.value,"onUpdate:modelValue":m[0]||(m[0]=v=>r.value=v),density:"compact",label:"Search","prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":""},null,8,["modelValue"]),a(i),a(z)]),_:1}),a(g),a(_,{search:r.value,"onUpdate:search":m[1]||(m[1]=v=>r.value=v),headers:d,items:U(l),loading:U(u),class:"px-4"},{"header.actions":n(()=>m[2]||(m[2]=[T("div",{class:"text-center"},null,-1)])),"item.image":n(({item:v})=>[a(V,{color:"grey",image:v.image||""},null,8,["image"])]),"item.actions":n(({item:v})=>[T("div",Y,[a(J,{item:v},null,8,["item"]),a(X,{item:v},null,8,["item"])])]),"no-data":n(()=>{var v;return[U(w)?(b(),h("div",Z,O((v=U(c))==null?void 0:v.message),1)):(b(),h("div",ee," No data yet... "))]}),_:1},8,["search","items","loading"])]),_:1})}}});export{ne as default};
